soniquedna.deepsantoshwar.xyz {
    # Explicitly route API paths to backend
    handle /spotify-auth-url* {
        reverse_proxy http://localhost:5500
    }
    
    handle /exchange-token* {
        reverse_proxy http://localhost:5500
    }
    
    handle /refresh-token* {
        reverse_proxy http://localhost:5500
    }
    
    handle /check-token* {
        reverse_proxy http://localhost:5500
    }
    
    handle /spotify-profile* {
        reverse_proxy http://localhost:5500
    }
    
    handle /logout* {
        reverse_proxy http://localhost:5500
    }
    
    handle /spotify-session-clear* {
        reverse_proxy http://localhost:5500
    }
    
    handle /musicrecommendation* {
        reverse_proxy http://localhost:5500
    }
    
    handle /music-recommendation* {
        reverse_proxy http://localhost:5500
    }
    
    handle /crossdomain-recommendations* {
        reverse_proxy http://localhost:5500
    }
    
    handle /crossdomain-progress* {
        reverse_proxy http://localhost:5500
    }
    
    handle /create-playlist* {
        reverse_proxy http://localhost:5500
    }
    
    handle /test-database* {
        reverse_proxy http://localhost:5500
    }
    
    handle /user-analytics* {
        reverse_proxy http://localhost:5500
    }
    
    handle /user-history* {
        reverse_proxy http://localhost:5500
    }
    
    handle /clear-cache* {
        reverse_proxy http://localhost:5500
    }
    
    handle /recommendations* {
        reverse_proxy http://localhost:5500
    }
    
    handle /auth* {
        reverse_proxy http://localhost:5500
    }
    
    handle /playlists* {
        reverse_proxy http://localhost:5500
    }
    
    handle /callback* {
        reverse_proxy http://localhost:5500
    }
    
    handle /health* {
        reverse_proxy http://localhost:5500
    }
    
    # Serve frontend files for everything else
    root * /home/ubuntu/SoniqueDNA/frontend/dist
    file_server
    
    # Handle SPA routing
    @notFile {
        not path *.js
        not path *.css
        not path *.ico
        not path *.png
        not path *.jpg
        not path *.jpeg
        not path *.gif
        not path *.svg
        not path *.woff
        not path *.woff2
        not path *.ttf
        not path *.eot
    }
    rewrite @notFile /index.html
} 